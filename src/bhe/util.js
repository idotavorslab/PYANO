"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function enumerate(obj) {
    let typeofObj = typeof obj;
    if (obj === undefined
        || isEmptyObj(obj)
        || isEmptyArr(obj)
        || obj === "") {
        return [];
    }
    if (obj === null
        || typeofObj === "boolean"
        || typeofObj === "number"
        || typeofObj === "function") {
        throw new TypeError(`${typeofObj} object is not iterable`);
    }
    let array = [];
    if (isArray(obj)) {
        let i = 0;
        for (let x of obj) {
            array.push([i, x]);
            i++;
        }
    }
    else {
        for (let prop in obj) {
            array.push([prop, obj[prop]]);
        }
    }
    return array;
}
exports.enumerate = enumerate;
function wait(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}
exports.wait = wait;
function bool(val) {
    if (!val) {
        return false;
    }
    const typeofval = typeof val;
    if (typeofval !== 'object') {
        if (typeofval === 'function') {
            return true;
        }
        else {
            return !!val;
        }
    }
    let toStringed = {}.toString.call(val);
    if (toStringed === '[object Object]' || toStringed === '[object Array]') {
        return Object.keys(val).length !== 0;
    }
    return !!val.valueOf();
}
exports.bool = bool;
function isArray(obj) {
    if (!obj) {
        return false;
    }
    return typeof obj !== 'string' && (Array.isArray(obj) || typeof obj[Symbol.iterator] === 'function');
}
exports.isArray = isArray;
function isEmptyArr(collection) {
    return isArray(collection) && getLength(collection) === 0;
}
exports.isEmptyArr = isEmptyArr;
function isEmptyObj(obj) {
    return isObject(obj) && !isArray(obj) && Object.keys(obj).length === 0;
}
exports.isEmptyObj = isEmptyObj;
function isFunction(fn) {
    let toStringed = {}.toString.call(fn);
    return !!fn && toStringed === '[object Function]';
}
exports.isFunction = isFunction;
function anyDefined(obj) {
    let array;
    if (isObject(obj)) {
        array = Object.values(obj);
    }
    else if (isArray(obj)) {
        array = obj;
    }
    else {
        throw new TypeError(`expected array or obj, got: ${typeof obj}`);
    }
    return array.filter(x => x !== undefined).length > 0;
}
exports.anyDefined = anyDefined;
function anyTruthy(obj) {
    let array;
    if (isObject(obj)) {
        array = Object.values(obj);
    }
    else if (isArray(obj)) {
        array = obj;
    }
    else {
        throw new TypeError(`expected array or obj, got: ${typeof obj}`);
    }
    return array.filter(x => bool(x)).length > 0;
}
exports.anyTruthy = anyTruthy;
function allUndefined(obj) {
    let array;
    if (isObject(obj)) {
        array = Object.values(obj);
    }
    else if (isArray(obj)) {
        array = obj;
    }
    else {
        throw new TypeError(`expected array or obj, got: ${typeof obj}`);
    }
    return array.filter(x => x !== undefined).length === 0;
}
exports.allUndefined = allUndefined;
async function waitUntil(cond, checkInterval = 20, timeout = Infinity) {
    if (checkInterval <= 0) {
        throw new Error(`checkInterval <= 0. checkInterval: ${checkInterval}`);
    }
    if (checkInterval > timeout) {
        throw new Error(`checkInterval > timeout (${checkInterval} > ${timeout}). checkInterval has to be lower than timeout.`);
    }
    const loops = timeout / checkInterval;
    if (loops <= 1) {
        console.warn(`loops <= 1, you probably didn't want this to happen`);
    }
    let count = 0;
    while (count < loops) {
        if (cond()) {
            return true;
        }
        await wait(checkInterval);
        count++;
    }
    return false;
}
exports.waitUntil = waitUntil;
function isBHE(bhe, bheSubType) {
    return (bhe instanceof bheSubType);
}
exports.isBHE = isBHE;
function isType(arg) {
    return true;
}
exports.isType = isType;
function isTMap(obj) {
    return {}.toString.call(obj) == '[object Object]';
}
exports.isTMap = isTMap;
function isObject(obj) {
    return typeof obj === 'object' && !!obj;
}
exports.isObject = isObject;
function shallowProperty(key) {
    return function (obj) {
        return obj == null ? void 0 : obj[key];
    };
}
exports.shallowProperty = shallowProperty;
function getLength(collection) {
    return shallowProperty('length')(collection);
}
exports.getLength = getLength;
const MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;
function isArrayLike(collection) {
    const length = getLength(collection);
    return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;
}
exports.isArrayLike = isArrayLike;
function extend(sup, child) {
    child.prototype = sup.prototype;
    const handler = {
        construct
    };
    function construct(_, argArray) {
        const obj = new child;
        sup.apply(obj, argArray);
        child.apply(obj, argArray);
        return obj;
    }
    const proxy = new Proxy(child, handler);
    return proxy;
}
exports.extend = extend;
function anyValue(obj) {
    let array;
    if (isObject(obj)) {
        array = Object.values(obj);
    }
    else if (isArray(obj)) {
        array = obj;
    }
    else {
        throw new TypeError(`expected array or obj, got: ${typeof obj}`);
    }
    return array.filter(x => Boolean(x)).length > 0;
}
exports.anyValue = anyValue;
function equalsAny(obj, ...others) {
    if (!others) {
        throw new Error('Not even one other was passed');
    }
    let strict = !(isArrayLike(obj) && isObject(obj[obj.length - 1]) && obj[obj.length - 1].strict == false);
    const _isEq = (_obj, _other) => strict ? _obj === _other : _obj == _other;
    for (let other of others) {
        if (_isEq(obj, other)) {
            return true;
        }
    }
    return false;
}
exports.equalsAny = equalsAny;
function noValue(obj) {
    let array;
    if (isObject(obj)) {
        array = Object.values(obj);
    }
    else if (isArray(obj)) {
        array = obj;
    }
    else {
        throw new TypeError(`expected array or obj, got: ${typeof obj}`);
    }
    return array.filter(x => Boolean(x)).length === 0;
}
exports.noValue = noValue;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFhQSxTQUFnQixTQUFTLENBQUksR0FBTTtJQWMvQixJQUFJLFNBQVMsR0FBRyxPQUFPLEdBQUcsQ0FBQztJQUMzQixJQUNJLEdBQUcsS0FBSyxTQUFTO1dBQ2QsVUFBVSxDQUFDLEdBQUcsQ0FBQztXQUNmLFVBQVUsQ0FBQyxHQUFHLENBQUM7V0FFZixHQUFHLEtBQUssRUFBRSxFQUNmO1FBQ0UsT0FBTyxFQUFtQixDQUFDO0tBQzlCO0lBRUQsSUFDSSxHQUFHLEtBQUssSUFBSTtXQUNULFNBQVMsS0FBSyxTQUFTO1dBQ3ZCLFNBQVMsS0FBSyxRQUFRO1dBQ3RCLFNBQVMsS0FBSyxVQUFVLEVBQzdCO1FBQ0UsTUFBTSxJQUFJLFNBQVMsQ0FBQyxHQUFHLFNBQVMseUJBQXlCLENBQUMsQ0FBQztLQUM5RDtJQUNELElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQztJQUNmLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQ2QsSUFBSSxDQUFDLEdBQVcsQ0FBQyxDQUFDO1FBQ2xCLEtBQUssSUFBSSxDQUFDLElBQUksR0FBRyxFQUFFO1lBQ2YsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ25CLENBQUMsRUFBRSxDQUFDO1NBQ1A7S0FDSjtTQUFNO1FBQ0gsS0FBSyxJQUFJLElBQUksSUFBSSxHQUFHLEVBQUU7WUFDbEIsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ2pDO0tBQ0o7SUFDRCxPQUFPLEtBQXNCLENBQUM7QUFDbEMsQ0FBQztBQTlDRCw4QkE4Q0M7QUFFRCxTQUFnQixJQUFJLENBQUMsRUFBVTtJQUMzQixPQUFPLElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMs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Q1YsSUFBSSxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDZixLQUFLLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQTtLQUM3QjtTQUFNLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQ3JCLEtBQUssR0FBRyxHQUFHLENBQUM7S0FDZjtTQUFNO1FBQ0gsTUFBTSxJQUFJLFNBQVMsQ0FBQywrQkFBK0IsT0FBTyxHQUFHLEVBQUUsQ0FBQyxDQUFBO0tBQ25FO0lBQ0QsT0FBTyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQTtBQUNyRCxDQUFDO0FBVkQsMEJBVUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBmdW5jdGlvbiBlbnVtZXJhdGUob2JqOiB1bmRlZmluZWQpOiBbdm9pZF07XG5cbi8vIGZ1bmN0aW9uIGVudW1lcmF0ZTxUPihvYmo6IFQpOiBuZXZlcjtcbi8vIGZ1bmN0aW9uIGVudW1lcmF0ZTxUPihvYmo6IFQpOiBba2V5b2YgVCwgVFtrZXlvZiBUXV1bXTtcblxuXG4vLyBmdW5jdGlvbiBlbnVtZXJhdGU8VD4ob2JqOiBUKTogVCBleHRlbmRzIHN0cmluZ1tdXG4vLyAgICAgPyBbbnVtYmVyLCBzdHJpbmddW11cbi8vICAgICA6IFtrZXlvZiBULCBUW2tleW9mIFRdXVtdIHtcbmltcG9ydCB7IEVudW1lcmF0ZWQsIFRNYXAgfSBmcm9tIFwiLi90eXBpbmdzXCI7XG5pbXBvcnQgeyBCZXR0ZXJIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luZGV4LmpzXCI7XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGVudW1lcmF0ZTxUPihvYmo6IFQpOiBFbnVtZXJhdGVkPFQ+IHtcbiAgICAvLyB1bmRlZmluZWQgICAgW11cbiAgICAvLyB7fSAgICAgICAgICAgW11cbiAgICAvLyBbXSAgICAgICAgICAgW11cbiAgICAvLyBcIlwiICAgICAgICAgICBbXVxuICAgIC8vIG51bWJlciAgICAgICBUeXBlRXJyb3JcbiAgICAvLyBudWxsICAgICAgICAgVHlwZUVycm9yXG4gICAgLy8gYm9vbGVhbiAgICAgIFR5cGVFcnJvclxuICAgIC8vIEZ1bmN0aW9uICAgICBUeXBlRXJyb3JcbiAgICAvLyBcImZvb1wiICAgICAgICBbIFswLCBcImZcIl0sIFsxLCBcIm9cIl0sIFsyLCBcIm9cIl0gXVxuICAgIC8vIFsgXCJmb29cIiBdICAgIFsgWzAsIFwiZm9vXCJdIF1cbiAgICAvLyBbIDEwIF0gICAgICAgWyBbMCwgMTBdIF1cbiAgICAvLyB7IGE6IFwiZm9vXCIgfSBbIFtcImFcIiwgXCJmb29cIl0gXVxuICAgIC8vIC8vICgpPT57fSAgICA/XG4gICAgbGV0IHR5cGVvZk9iaiA9IHR5cGVvZiBvYmo7XG4gICAgaWYgKFxuICAgICAgICBvYmogPT09IHVuZGVmaW5lZFxuICAgICAgICB8fCBpc0VtcHR5T2JqKG9iailcbiAgICAgICAgfHwgaXNFbXB0eUFycihvYmopXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgfHwgb2JqID09PSBcIlwiXG4gICAgKSB7XG4gICAgICAgIHJldHVybiBbXSBhcyBFbnVtZXJhdGVkPFQ+O1xuICAgIH1cblxuICAgIGlmIChcbiAgICAgICAgb2JqID09PSBudWxsXG4gICAgICAgIHx8IHR5cGVvZk9iaiA9PT0gXCJib29sZWFuXCJcbiAgICAgICAgfHwgdHlwZW9mT2JqID09PSBcIm51bWJlclwiXG4gICAgICAgIHx8IHR5cGVvZk9iaiA9PT0gXCJmdW5jdGlvblwiXG4gICAgKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCR7dHlwZW9mT2JqfSBvYmplY3QgaXMgbm90IGl0ZXJhYmxlYCk7XG4gICAgfVxuICAgIGxldCBhcnJheSA9IFtdO1xuICAgIGlmIChpc0FycmF5KG9iaikpIHtcbiAgICAgICAgbGV0IGk6IG51bWJlciA9IDA7XG4gICAgICAgIGZvciAobGV0IHggb2Ygb2JqKSB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKFtpLCB4XSk7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKGxldCBwcm9wIGluIG9iaikge1xuICAgICAgICAgICAgYXJyYXkucHVzaChbcHJvcCwgb2JqW3Byb3BdXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFycmF5IGFzIEVudW1lcmF0ZWQ8VD47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3YWl0KG1zOiBudW1iZXIpOiBQcm9taXNlPGFueT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJvb2wodmFsOiBhbnkpOiBib29sZWFuIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICdmb28nICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbihmYWxzZSkgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKHRydWUpICAgICAgICB0cnVlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgIHRydWVcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gTnVtYmVyKDApICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoMSkgICAgICAgICAgICB0cnVlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDAgXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIFsgW10gXSAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBbIGZhbHNlIF0gICAgICAgICAgICB0cnVlXG4gICAgLy8gWyB0cnVlIF0gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIFtdICAgICAgICAgICAgICAgICAgIGZhbHNlICAgICAgIHVubGlrZSBuYXRpdmVcbiAgICAvLyBkb2N1bWVudC5ib2R5ICAgICAgICB0cnVlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgICB0cnVlXG4gICAgLy8gbmV3IEJvb2xlYW4gICAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgICAgIGZhbHNlICAgICAgIHVubGlrZSBuYXRpdmVcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSkgICBmYWxzZSAgICAgICB1bmxpa2UgbmF0aXZlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgICAgdHJ1ZVxuICAgIC8vIG5ldyBGdW5jdGlvbiAgICAgICAgIHRydWVcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgICB0cnVlXG4gICAgLy8gbmV3IE51bWJlciAgICAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICAgIGZhbHNlICAgICAgIHVubGlrZSBuYXRpdmVcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgICB0cnVlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIC8vIG5ldyBUaW1lbGluZSguLi4pICAgIHRydWVcbiAgICAvLyBuZXcgY2xhc3N7fSAgICAgICAgICBmYWxzZSAgICAgICB1bmxpa2UgbmF0aXZlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB7IGhpIDogJ2J5ZScgfSAgICAgICB0cnVlXG4gICAgLy8ge30gICAgICAgICAgICAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuXG5cbiAgICBpZiAoIXZhbCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IHR5cGVvZnZhbCA9IHR5cGVvZiB2YWw7XG4gICAgaWYgKHR5cGVvZnZhbCAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgaWYgKHR5cGVvZnZhbCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gISF2YWw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gbGV0IGtleXNMZW5ndGggPSBPYmplY3Qua2V5cyh2YWwpLmxlbmd0aDtcbiAgICBsZXQgdG9TdHJpbmdlZCA9IHt9LnRvU3RyaW5nLmNhbGwodmFsKTtcbiAgICBpZiAodG9TdHJpbmdlZCA9PT0gJ1tvYmplY3QgT2JqZWN0XScgfHwgdG9TdHJpbmdlZCA9PT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModmFsKS5sZW5ndGggIT09IDA7XG4gICAgfVxuXG4gICAgLy8gQm9vbGVhbiwgTnVtYmVyLCBIVE1MRWxlbWVudC4uLlxuICAgIHJldHVybiAhIXZhbC52YWx1ZU9mKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0FycmF5PFQ+KG9iaik6IG9iaiBpcyBBcnJheTxUPiB7IC8vIHNhbWUgYXMgQXJyYXkuaXNBcnJheVxuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnZm9vJyAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBbIDEgXSAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyBbXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICAgZmFsc2VcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgIGZhbHNlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgICBmYWxzZVxuICAgIC8vIHt9ICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBpZiAoIW9iaikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0eXBlb2Ygb2JqICE9PSAnc3RyaW5nJyAmJiAoQXJyYXkuaXNBcnJheShvYmopIHx8IHR5cGVvZiBvYmpbU3ltYm9sLml0ZXJhdG9yXSA9PT0gJ2Z1bmN0aW9uJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0VtcHR5QXJyKGNvbGxlY3Rpb24pOiBib29sZWFuIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gW10gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKSAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSAgIGZhbHNlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgICBmYWxzZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgZmFsc2VcbiAgICAvLyB7fSAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgcmV0dXJuIGlzQXJyYXkoY29sbGVjdGlvbikgJiYgZ2V0TGVuZ3RoKGNvbGxlY3Rpb24pID09PSAwXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0VtcHR5T2JqKG9iaik6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgIGZhbHNlXG4gICAgLy8gLyBuZXcgQm9vbGVhbigpICAgICB0cnVlXG4gICAgLy8gLyBuZXcgQm9vbGVhbihmYWxzZSl0cnVlXG4gICAgLy8gLyBuZXcgQm9vbGVhbih0cnVlKSB0cnVlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgICBmYWxzZVxuICAgIC8vIC8gbmV3IE51bWJlcigwKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IE51bWJlcigxKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IE51bWJlcigpICAgICAgdHJ1ZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgZmFsc2VcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICByZXR1cm4gaXNPYmplY3Qob2JqKSAmJiAhaXNBcnJheShvYmopICYmIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwXG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRnVuY3Rpb248Rj4oZm46IEYpOiBmbiBpcyBGXG5leHBvcnQgZnVuY3Rpb24gaXNGdW5jdGlvbihmbjogKC4uLmFyZ3M6IGFueVtdKSA9PiBhbnkpOiBmbiBpcyAoLi4uYXJnczogYW55W10pID0+IGFueVxuZXhwb3J0IGZ1bmN0aW9uIGlzRnVuY3Rpb24oZm4pIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvICgpPT57fSAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gQm9vbGVhbiAgICAgICAgICAgICB0cnVlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gRnVuY3Rpb24gICAgICAgICAgICB0cnVlXG4gICAgLy8gLyBGdW5jdGlvbigpICAgICAgICAgIHRydWVcbiAgICAvLyAvIE51bWJlciAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIGZ1bmN0aW9uKCl7fSAgICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSkgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgICBmYWxzZVxuICAgIC8vIC8gbmV3IEZ1bmN0aW9uKCkgICAgICB0cnVlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgIGZhbHNlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgICBmYWxzZVxuICAgIC8vIHt9ICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBsZXQgdG9TdHJpbmdlZCA9IHt9LnRvU3RyaW5nLmNhbGwoZm4pO1xuICAgIHJldHVybiAhIWZuICYmIHRvU3RyaW5nZWQgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFueURlZmluZWQob2JqKTogYm9vbGVhbiB7XG4gICAgbGV0IGFycmF5O1xuICAgIGlmIChpc09iamVjdChvYmopKSB7XG4gICAgICAgIGFycmF5ID0gT2JqZWN0LnZhbHVlcyhvYmopO1xuICAgIH0gZWxzZSBpZiAoaXNBcnJheShvYmopKSB7XG4gICAgICAgIGFycmF5ID0gb2JqO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYGV4cGVjdGVkIGFycmF5IG9yIG9iaiwgZ290OiAke3R5cGVvZiBvYmp9YCk7XG4gICAgfVxuICAgIHJldHVybiBhcnJheS5maWx0ZXIoeCA9PiB4ICE9PSB1bmRlZmluZWQpLmxlbmd0aCA+IDA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhbnlUcnV0aHkob2JqKTogYm9vbGVhbiB7XG4gICAgbGV0IGFycmF5O1xuICAgIGlmIChpc09iamVjdChvYmopKSB7XG4gICAgICAgIGFycmF5ID0gT2JqZWN0LnZhbHVlcyhvYmopO1xuICAgIH0gZWxzZSBpZiAoaXNBcnJheShvYmopKSB7XG4gICAgICAgIGFycmF5ID0gb2JqO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYGV4cGVjdGVkIGFycmF5IG9yIG9iaiwgZ290OiAke3R5cGVvZiBvYmp9YCk7XG4gICAgfVxuICAgIHJldHVybiBhcnJheS5maWx0ZXIoeCA9PiBib29sKHgpKS5sZW5ndGggPiAwO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWxsVW5kZWZpbmVkKG9iaik6IGJvb2xlYW4ge1xuICAgIGxldCBhcnJheTtcbiAgICBpZiAoaXNPYmplY3Qob2JqKSkge1xuICAgICAgICBhcnJheSA9IE9iamVjdC52YWx1ZXMob2JqKVxuICAgIH0gZWxzZSBpZiAoaXNBcnJheShvYmopKSB7XG4gICAgICAgIGFycmF5ID0gb2JqO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYGV4cGVjdGVkIGFycmF5IG9yIG9iaiwgZ290OiAke3R5cGVvZiBvYmp9YClcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5LmZpbHRlcih4ID0+IHggIT09IHVuZGVmaW5lZCkubGVuZ3RoID09PSAwXG59XG5cbi8qKkNoZWNrIGV2ZXJ5IGBjaGVja0ludGVydmFsYCBtcyBpZiBgY29uZCgpYCBpcyB0cnV0aHkuIElmLCB3aXRoaW4gYHRpbWVvdXRgLCBjb25kKCkgaXMgdHJ1dGh5LCByZXR1cm4gYHRydWVgLiBSZXR1cm4gYGZhbHNlYCBpZiB0aW1lIGlzIG91dC5cbiAqIEBleGFtcGxlXG4gKiAvLyBHaXZlIHRoZSB1c2VyIGEgMjAwbXMgY2hhbmNlIHRvIGdldCBoZXIgcG9pbnRlciBvdmVyIFwibXlkaXZcIi4gQ29udGludWUgaW1tZWRpYXRlbHkgb25jZSBzaGUgZG9lcywgb3IgYWZ0ZXIgMjAwbXMgaWYgc2hlIGRvZXNuJ3QuXG4gKiBteWRpdi5wb2ludGVyZW50ZXIoICgpID0+IG15ZGl2LnBvaW50ZXJIb3ZlcmluZyA9IHRydWU7IClcbiAqIGNvbnN0IHBvaW50ZXJPbk15ZGl2ID0gYXdhaXQgd2FpdFVudGlsKCgpID0+IG15ZGl2LnBvaW50ZXJIb3ZlcmluZywgMjAwLCAxMCk7Ki9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3YWl0VW50aWwoY29uZDogKCkgPT4gYm9vbGVhbiwgY2hlY2tJbnRlcnZhbDogbnVtYmVyID0gMjAsIHRpbWVvdXQ6IG51bWJlciA9IEluZmluaXR5KTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKGNoZWNrSW50ZXJ2YWwgPD0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGNoZWNrSW50ZXJ2YWwgPD0gMC4gY2hlY2tJbnRlcnZhbDogJHtjaGVja0ludGVydmFsfWApO1xuICAgIH1cbiAgICBpZiAoY2hlY2tJbnRlcnZhbCA+IHRpbWVvdXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBjaGVja0ludGVydmFsID4gdGltZW91dCAoJHtjaGVja0ludGVydmFsfSA+ICR7dGltZW91dH0pLiBjaGVja0ludGVydmFsIGhhcyB0byBiZSBsb3dlciB0aGFuIHRpbWVvdXQuYCk7XG4gICAgfVxuXG4gICAgY29uc3QgbG9vcHMgPSB0aW1lb3V0IC8gY2hlY2tJbnRlcnZhbDtcbiAgICBpZiAobG9vcHMgPD0gMSkge1xuICAgICAgICBjb25zb2xlLndhcm4oYGxvb3BzIDw9IDEsIHlvdSBwcm9iYWJseSBkaWRuJ3Qgd2FudCB0aGlzIHRvIGhhcHBlbmApO1xuICAgIH1cbiAgICBsZXQgY291bnQgPSAwO1xuICAgIHdoaWxlIChjb3VudCA8IGxvb3BzKSB7XG4gICAgICAgIGlmIChjb25kKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHdhaXQoY2hlY2tJbnRlcnZhbCk7XG4gICAgICAgIGNvdW50Kys7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQkhFPFQgZXh0ZW5kcyBCZXR0ZXJIVE1MRWxlbWVudD4oYmhlOiBULCBiaGVTdWJUeXBlKTogYmhlIGlzIFQge1xuICAgIHJldHVybiAoYmhlIGluc3RhbmNlb2YgYmhlU3ViVHlwZSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVHlwZTxUPihhcmc6IFQpOiBhcmcgaXMgVCB7XG4gICAgcmV0dXJuIHRydWVcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVE1hcDxUPihvYmo6IFRNYXA8VD4pOiBvYmogaXMgVE1hcDxUPiB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSBmYWxzZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgZmFsc2VcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIHsgaGkgOiAnYnllJyB9ICAgIHRydWVcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICByZXR1cm4ge30udG9TdHJpbmcuY2FsbChvYmopID09ICdbb2JqZWN0IE9iamVjdF0nXG59XG5cblxuLy8gKiAgdW5kZXJzY29yZS5qc1xuLyoqdHJ1ZSBmb3IgYW55IG5vbi1wcmltaXRpdmUsIGluY2x1ZGluZyBhcnJheSwgZnVuY3Rpb24qL1xuZXhwb3J0IGZ1bmN0aW9uIGlzT2JqZWN0KG9iaik6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIFsgMSBdICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvIFtdICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4oKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4oZmFsc2UpdHJ1ZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4odHJ1ZSkgdHJ1ZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyAvIG5ldyBOdW1iZXIoMCkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBOdW1iZXIoMSkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBOdW1iZXIoKSAgICAgIHRydWVcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIHsgaGkgOiAnYnllJyB9ICAgIHRydWVcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgISFvYmo7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaGFsbG93UHJvcGVydHk8VD4oa2V5OiBzdHJpbmcpOiAob2JqOiBUKSA9PiBUIGV4dGVuZHMgbnVsbCA/IHVuZGVmaW5lZCA6IFRba2V5b2YgVF0ge1xuICAgIHJldHVybiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIHJldHVybiBvYmogPT0gbnVsbCA/IHZvaWQgMCA6IG9ialtrZXldO1xuICAgIH07XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExlbmd0aChjb2xsZWN0aW9uKTogbnVtYmVyIHtcbiAgICByZXR1cm4gc2hhbGxvd1Byb3BlcnR5KCdsZW5ndGgnKShjb2xsZWN0aW9uKVxufVxuXG5cbmNvbnN0IE1BWF9BUlJBWV9JTkRFWCA9IE1hdGgucG93KDIsIDUzKSAtIDE7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0FycmF5TGlrZShjb2xsZWN0aW9uKTogYm9vbGVhbiB7XG4gICAgY29uc3QgbGVuZ3RoID0gZ2V0TGVuZ3RoKGNvbGxlY3Rpb24pO1xuICAgIHJldHVybiB0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInICYmIGxlbmd0aCA+PSAwICYmIGxlbmd0aCA8PSBNQVhfQVJSQVlfSU5ERVg7XG59XG5cblxuLy8gKiAgbWlzY1xuLy8gY2hpbGQgZXh0ZW5kcyBzdXBcbmV4cG9ydCBmdW5jdGlvbiBleHRlbmQoc3VwLCBjaGlsZCkge1xuICAgIGNoaWxkLnByb3RvdHlwZSA9IHN1cC5wcm90b3R5cGU7XG4gICAgY29uc3QgaGFuZGxlciA9IHtcbiAgICAgICAgY29uc3RydWN0XG4gICAgfTtcblxuICAgIC8vIFwibmV3IEJveUNsc1wiXG4gICAgZnVuY3Rpb24gY29uc3RydWN0KF8sIGFyZ0FycmF5KSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IG5ldyBjaGlsZDtcbiAgICAgICAgc3VwLmFwcGx5KG9iaiwgYXJnQXJyYXkpOyAgICAvLyBjYWxscyBQZXJzb25DdG9yLiBTZXRzIG5hbWVcbiAgICAgICAgY2hpbGQuYXBwbHkob2JqLCBhcmdBcnJheSk7IC8vIGNhbGxzIEJveUN0b3IuIFNldHMgYWdlXG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuXG5cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkoY2hpbGQsIGhhbmRsZXIpO1xuICAgIHJldHVybiBwcm94eTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFueVZhbHVlKG9iaikge1xuICAgIGxldCBhcnJheTtcbiAgICBpZiAoaXNPYmplY3Qob2JqKSkge1xuICAgICAgICBhcnJheSA9IE9iamVjdC52YWx1ZXMob2JqKTtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkob2JqKSkge1xuICAgICAgICBhcnJheSA9IG9iajtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBleHBlY3RlZCBhcnJheSBvciBvYmosIGdvdDogJHt0eXBlb2Ygb2JqfWApO1xuICAgIH1cbiAgICByZXR1cm4gYXJyYXkuZmlsdGVyKHggPT4gQm9vbGVhbih4KSkubGVuZ3RoID4gMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVxdWFsc0FueShvYmo6IGFueSwgLi4ub3RoZXJzOiBhbnlbXSk6IGJvb2xlYW4ge1xuICAgIGlmICghb3RoZXJzKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm90IGV2ZW4gb25lIG90aGVyIHdhcyBwYXNzZWQnKTtcbiAgICB9XG4gICAgbGV0IHN0cmljdCA9ICEoaXNBcnJheUxpa2Uob2JqKSAmJiBpc09iamVjdChvYmpbb2JqLmxlbmd0aCAtIDFdKSAmJiBvYmpbb2JqLmxlbmd0aCAtIDFdLnN0cmljdCA9PSBmYWxzZSk7XG4gICAgY29uc3QgX2lzRXEgPSAoX29iaiwgX290aGVyKSA9PiBzdHJpY3QgPyBfb2JqID09PSBfb3RoZXIgOiBfb2JqID09IF9vdGhlcjtcbiAgICBmb3IgKGxldCBvdGhlciBvZiBvdGhlcnMpIHtcbiAgICAgICAgaWYgKF9pc0VxKG9iaiwgb3RoZXIpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub1ZhbHVlKG9iaik6IGJvb2xlYW4ge1xuICAgIGxldCBhcnJheTtcbiAgICBpZiAoaXNPYmplY3Qob2JqKSkge1xuICAgICAgICBhcnJheSA9IE9iamVjdC52YWx1ZXMob2JqKVxuICAgIH0gZWxzZSBpZiAoaXNBcnJheShvYmopKSB7XG4gICAgICAgIGFycmF5ID0gb2JqO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYGV4cGVjdGVkIGFycmF5IG9yIG9iaiwgZ290OiAke3R5cGVvZiBvYmp9YClcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5LmZpbHRlcih4ID0+IEJvb2xlYW4oeCkpLmxlbmd0aCA9PT0gMFxufVxuXG5cblxuXG5cblxuIl19