let { Python, EStore } = require("pyano_local_modules/ext_libs");


/**@param {string} subjectIdInputVal*/
function check_create_new_subject(subjectIdInputVal) {

	// Set new subject in Estore/subjects if new; else nothing
	const subjectsDirPath = EStore.subjectsDirPath();
	let pyoptions = {
		args: [subjectIdInputVal, subjectsDirPath]
	};
	Python.run("NewTest/check_create_new_subject.py", pyoptions, (err, response) => {
		if (err) throw err;
		// noinspection JSCheckFunctionSignatures
		response = JSON.parse(response);
		let subjectPath = Path.join(subjectsDirPath, subjectIdInputVal);

		if (response == "created") {
			Alert.small.info(`New subject created: ${subjectIdInputVal}`, subjectPath);

		} else if (response == "exists") {
			Alert.small.success(`Using existing subject: ${subjectIdInputVal}`, subjectPath);
		}


	});

}

async function validate_fix_saved_config_file(configfilepath) {
	await Python.runAsync('NewTest/validate_fix_saved_config_file.py', {
		mode: "json",
		args: [configfilepath, EStore.root_abs_path]
	});
}

module.exports = { check_create_new_subject, validate_fix_saved_config_file };
